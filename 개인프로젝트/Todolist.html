<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>To-Do List</title>
    <link rel="preconnect" href="https://fonts.googleapis.com"> <!-- í°íŠ¸ ë³€ê²½ -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">

    <link rel="shortcut icon" href="../images/icon2.png" type="image/x-icon"> <!-- íƒ­ ì˜† ì´ë¯¸ì§€ -->
    <link rel="stylesheet" href="../ê°œì¸í”„ë¡œì íŠ¸/toDoStyle.css">
 <style>
    .todoList {
        padding-left: 3%;
        text-align: left;
        font-weight: 700;
        list-style: none;   /* ë¦¬ìŠ¤íŠ¸ ì (Â·) ì—†ì• ê¸° */
        margin: 5px;
    }

    .todoList li {    /* todolistì˜ li */
        margin: 0;
        padding: 0;
    }

    .todoList button {
    font-size: 13px;
    padding: 5px;
    background-color: rgba(255, 255, 255, 0);
    outline: none;
    border: none;
    }

    .todoList button:hover {    /* ë§ˆìš°ìŠ¤ì˜¤ë²„ ì‹œ ëª¨ì–‘ ë³€ê²½ */
    cursor: pointer;
    opacity: 0.5;
    }

    .todoList span {
    margin-left: 10px;
    }

</style>
</head>
<body>
    <div id="modal">
        <div id="modalCon">
            <br><h3>â¤ï¸ğŸ§¡ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ¤</h3><h1>To-Do List</h1>
            <input type="text" class="modalBar" placeholder="ì˜¤ëŠ˜ì˜ ë‹¤ì§ì„ ì ê³  í˜ì°¨ê²Œ í•˜ë£¨ë¥¼ ì‹œì‘í•©ì‹œë‹¤^ã…^" style="font-size:21px;" autofocus>
            <br><br><br><br><br><br><br><br>
            <input type="button" value="âœï¸" onclick="f_modalClose()"> 
        </div>
    </div>
    <div id="wrapper">
        <div style=" text-align: center;">
            <input type="button" value=" ğŸ€ " style="text-align: center; display: inline-block; border: 0; cursor: pointer; border-radius: 80px;" onclick="f_modalOpen()">
        </div>
    </div>
    <div id="nemo">
        <div id="now2"><br><br>0000-00-00</div>
        <div id="now">00 : 00 : 00</div>
        <div id="mal"><br></div>
        <input type="text" class="bar" placeholder="To do list" style="font-size:15px;" autofocus>
        <div id="enter" onmouseover="f_over(this)" onmouseout="f_out(this)" style="cursor: pointer;"></div>
        <div>
            <ul id="content" class="todoList" style="font-size: 23px; text-align: left; overflow: auto;"></ul>
        </div>
    </div>
<script>
 
    // ë“±ë¡ë²„íŠ¼ ë§ˆìš°ìŠ¤ì˜¤ë²„ ì‹œ ìƒ‰ê¹”ìˆëŠ” ì´ë¯¸ì§€ë¡œ ë³€ê²½
    function f_over(p_this) {
        var v_enter = document.querySelector("#enter");
        v_enter.style.backgroundImage = 'url("../images/todo2.png")';
    }
    
    function f_out(p_this) {
        var v_enter = document.querySelector("#enter");
        v_enter.style.backgroundImage = 'url("../images/todo.png")';
    }

    // enterë¡œ ì…ë ¥ ë‚´ìš© ë“±ë¡í•˜ê¸°
    var v_barEnter = document.querySelector(".bar");
    v_barEnter.addEventListener("keydown",function() {
        if(event.keyCode == 13) {
            f_toDo();
        }
    })
    
    // todo ë‚´ìš© ë“±ë¡í•˜ê¸°
    let v_toDoList = document.querySelector("#content");
    var v_add = document.querySelector("#enter");

    var todos ;  // ì…ë ¥ê°’ ë°°ì—´ìš©

    // ì™„ë£Œ ì²´í¬
    function f_ok() {
        var v_okBtn = event.target;
        var v_str = v_okBtn.getAttribute("id"); 

        var v_arrIdex = v_str.substr(v_str.length -1,1); 
        // //í•´ë‹¹ì¸ë±ìŠ¤ Y,N.. ìƒíƒœ ë°”ê¿”ì£¼ëŠ”ê±° í•´ì•¼ëŒã… 

        var v_span = v_okBtn.parentElement.children[2]; // liì˜ 3ë²ˆì§¸ ìì‹(ì¸ë±ìŠ¤ 2)ì¸ <span>íƒœê·¸ë¥¼ ì˜ë¯¸
        if(v_span.style.textDecoration == 'line-through'){
            v_span.style.textDecoration ="none";
            v_span.style.color = 'rgb(0, 0, 0)';
        }else {
            v_span.style.textDecoration ="line-through"
            v_span.style.color = 'rgb(197, 197, 197)';
        }  
    }

    // ì‚­ì œ
    function f_del() {
        var v_btn = event.target;       //<button>
        var v_li = v_btn.parentElement; //<li>
        var v_id = v_btn.id; 
        v_id = v_id.substr(v_id.length-1,1); 
        
        var v_datas = JSON.parse(localStorage.getItem("toDoKey"));
        v_datas.splice(v_id,1); 
        localStorage.setItem("toDoKey", JSON.stringify(v_datas));  
        
        v_li.remove(); // li ìŠ¤ìŠ¤ë¡œ ì‚­ì ±

        // ë°©ë²• 2 í˜ì´ì§€ ë¦¬ë¡œë“œ
        // location.href = location.href; 
        }


    // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë°œìƒ
    function f_toDo(){ 
        var li = document.createElement('li'); // liíƒœê·¸ ìƒì„±
        var v_btnX = document.createElement('button');
        v_btnX.innerHTML='âŒ';
        li.appendChild(v_btnX); // liíƒœê·¸ì— Xë²„íŠ¼ ë¶™ì´ê¸°
        v_btnX.addEventListener("click", f_del); // ì‚­ì œ í´ë¦­ ì´ë²¤íŠ¸

        v_btnV = document.createElement('button');
        v_btnV.innerHTML='âœ”ï¸';

        var v_idNum = document.querySelectorAll("li").length;
        v_btnV.setAttribute("id",v_idNum);


        li.appendChild(v_btnV);
        v_btnV.addEventListener("click", f_ok); // ì™„ë£Œ í´ë¦­ ì´ë²¤íŠ¸

        var v_span = document.createElement('span');
        v_span.innerHTML = v_barEnter.value;
        li.appendChild(v_span); // *span íƒœê·¸ : ë¬¸ì¥ ë‹¨ìœ„ë¡œ í…ìŠ¤íŠ¸ ì˜ì—­ì„ ì§€ì •
 
        if (!v_barEnter.value)   // ì…ë ¥ì°½ì— ë‚´ìš©ì´ ì…ë ¥ë˜ì§€ ì•Šìœ¼ë©´ ì•Œë¦¼ì°½
            alert('ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.');
        else {
            if (!localStorage.getItem("toDoKey")) {
                todos = [];
            } else {
                todos = JSON.parse(localStorage.getItem("toDoKey")); // To Do List ì…ë ¥ê°’ ë°°ì—´ë¡œ ì €ì¥
            }
            var v_toDo = {};
            v_toDo.data = v_barEnter.value;
            v_toDo.complete = 'N'; 
            todos.push(v_toDo); // ë°°ì—´ ë§¨ ë’¤ì— ë“¤ì–´ê°€
            localStorage.setItem("toDoKey",JSON.stringify(todos));

            v_toDoList.appendChild(li);
            v_barEnter.value= "";         // ì…ë ¥ì°½ ì´ˆê¸°í™”
        }
    }
    v_add.addEventListener('click',f_toDo);


    // ìƒˆë¡œê³ ì¹¨(ì¬ì ‘ì†) í•  ë•Œë§ˆë‹¤ ë°°ê²½ ì´ë¯¸ì§€ ëœë¤ìœ¼ë¡œ ë³€ê²½
    var backArr = new Array();
    backArr[0] = "../images/ë°°ê²½1.jpg";
    backArr[1] = "../images/ë°°ê²½2.jpg";
    backArr[2] = "../images/ë°°ê²½3.jpg";
    backArr[3] = "../images/ë°°ê²½4.jpg";
    backArr[4] = "../images/ë°°ê²½5.jpg";
    backArr[5] = "../images/ë°°ê²½6.jpg";
    backArr[6] = "../images/ë°°ê²½7.jpg";
    backArr[7] = "../images/ë°°ê²½8.jpg";
    
    var obj = document.getElementById('wrapper');
    var backRan = Math.floor(Math.random()*(backArr.length));
    j = (isNaN(backRan)) ? 0 : backRan; // backRanì´ ìˆ«ìê°€ ì•„ë‹ˆë©´ 0 
    obj.style.backgroundImage = 'url(' + backArr[backRan] + ')';


    // í˜„ì¬ ì‹œê°„ ë‚˜íƒ€ë‚´ê¸°
    function f_now() {
        
        var v_today = new Date();

        // ìš”ì¼ ë„£ê¸°
        // var week = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];
        // var v_day = week[v_today.getDay];

        var v_year = v_today.getFullYear();

        var v_month = v_today.getMonth() +1; // 0~11... 1ì›”ì´ 0ìœ¼ë¡œ í‘œí˜„ë˜ê¸° ë•Œë¬¸ì— +1
        if(v_month < 10) {
            v_month = "0" + v_month;
        }

        var v_date = v_today.getDate();

        var v_hour = v_today.getHours();
        if(v_hour < 10) {
            v_hour = "0" + v_hour; 
        }

        var v_min = v_today.getMinutes();
        if(v_min < 10) {
            v_min = "0" + v_min;
        }

        var v_sec = v_today.getSeconds();
        if(v_sec < 10) {
            v_sec = "0" + v_sec;
        }

        now2.innerHTML = "<br>" + v_year + "-" + v_month + "-" + v_date;
        now.innerHTML = v_hour + " : " + v_min + " : " + v_sec;
        setTimeout(f_now,1000);
    }
    
    f_now();
    
    
    window.onload = function(){  // ì´ë²¤íŠ¸=function(){} ê±°ë‚˜ í•¨ìˆ˜ëª…ë§Œ

    // ìƒˆë¡œê³ ì¹¨í•´ë„ ë°ì´í„°(todolist)ê°€ ë‚¨ì•„ìˆê²Œ í•˜ê¸°
    // ê°’ì´ ì—†ì„ë•Œ ì¡°ê±´ + ë‹¤ êº¼ë‚´ì™€ì„œ ì°ì–´ì£¼ëŠ”ê±° í•„ìš”...
    var v_save = JSON.parse(localStorage.getItem("toDoKey"));
    
    if(v_save == null) {
        return;
        }
        for(var i=0; i<v_save.length; i++) {
            var li = document.createElement('li');
            var v_btnX = document.createElement('button');
            v_btnX.setAttribute("id","x"+i); // setAttribute: ì„ íƒí•œ ìš”ì†Œì˜ ì†ì„± ê°’ì„ ì •í•¨ (ì†ì„±ì´ë¦„,ê°’)
            v_btnX.innerHTML='âŒ';
            li.appendChild(v_btnX);
            v_btnX.addEventListener("click", f_del);
            
            v_btnV = document.createElement('button');
            v_btnV.setAttribute("id","v"+i); // id: v1, v2...
            v_btnV.innerHTML='âœ”ï¸';
            li.appendChild(v_btnV);
            v_btnV.addEventListener("click", f_ok);
            
            var v_span = document.createElement('span');
            v_span.innerHTML = v_save[i].data;
            if(v_save[i].complete == 'Y'){
                v_span.style.textDecoration = "line-through";
                v_span.style.color = 'rgb(197, 197, 197)';
            }
            li.appendChild(v_span);
            
            v_toDoList.appendChild(li);   
        }
    }
    
    // (ëª¨ë‹¬) enterë¡œ ì…ë ¥ ë‚´ìš© ë“±ë¡í•˜ê¸°
    var v_modalEnter = document.querySelector(".modalBar");
    v_modalEnter.addEventListener("keydown",function() {
    if(event.keyCode == 13) {
        f_Go();
    }
})

var v_mal = document.querySelector("#mal");
    
var v_datas ; // ë°°ì—´ìš©.. ì„ ì–¸ ë¨¼ì € í•´ë‘ê¸°

function f_Go() {
    if (!v_modalEnter.value)   // ì…ë ¥ì°½ì— ë‚´ìš©ì´ ì…ë ¥ë˜ì§€ ì•Šìœ¼ë©´ ì•Œë¦¼ì°½
        alert('ì…ë ¥í•´');
    else {
        // ì ì€ê±° ì‚¬ë¼ì§€ì§€ ì•Šê³  ëœ¨ê²Œ
        v_mal.innerHTML = v_modalEnter.value; // ê¸°ë³¸ valueê°’ì´ ì—†ìœ¼ë©´ innerHTMLì„ ì‚¬ìš©í•œë‹¤!
        
        if(!localStorage.getItem("malKey")){
            v_datas = []; // ë¹ˆ ë°°ì—´ 
        } else {
            v_datas = JSON.parse(localStorage.getItem("malKey")); // ì…ë ¥í•œ ë‚´ìš©ì´ ìˆìœ¼ë©´ valueê°’ì— ì €ì¥
        }
        v_datas.push(v_modalEnter.value);
        localStorage.setItem("malKey", JSON.stringify(v_datas));
        f_modalClose();
    }
}

var v_modal = document.querySelector("#modal");

function f_modalOpen() { 
        v_modal.style.display = "block"; // ë³´ì´ê²Œ 
    }

function f_modalClose() {
        if (!v_modalEnter.value)   // ì…ë ¥ì°½ì— ë‚´ìš©ì´ ì…ë ¥ë˜ì§€ ì•Šìœ¼ë©´ ì•Œë¦¼ì°½
        alert('ì…ë ¥í•´');
    else {
        v_modal.style.display = "none"; // ëª¨ë‹¬ì°½ ì•ˆ ë³´ì´ê²Œ(ì¢…ë£Œ)
    }
}

</script>
</body>
</html>